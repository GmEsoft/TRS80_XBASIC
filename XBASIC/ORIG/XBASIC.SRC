°°°°° 	;XBASIC	12/04/86°°°°± DEFV	MACRO	#A,#B°°°°² 	ORG	#A°°°°³ 	JP	#B°°°°´ 	ENDM°°°±° JRIF	MACRO	#A°°°±± 	LD	DE,#A°°°±² 	CALL	1C90H°°°±³ 	JR	Z,CG°°°±´ 	ENDM°°°±µ MOVE	MACRO	#A,#B,#C°°°±¶ 	LD	HL,#A°°°±· 	LD	DE,#B°°°±¸ 	LD	BC,#C°°°±¹ 	RST	30H°°°²° 	ENDM°°±°° 	DEFV	41BEH,PRE°°±²° 	DEFV	41CAH,PRI°°±´° 	DEFV	41ACH,XRES°°±¶° 	DEFV	400FH,TTSP°°±¸° 	DEFV	4006H,TT3°°²°° 	DEFV	41C1H,TT4°°²²° 	DEFV	41D0H,TT1°°²´° 	DEFV	41C4H,T1°°²¶° 	DEFV	4003H,RST16°°²¸° 	ORG	42F0H°°²¹° RST16	PUSH	IX°°³°° 	EXX°°³±° 	LD	IX,0°°³²° 	ADD	IX,SP°°³´° 	LD	L,(IX+4)°°³µ° 	LD	H,(IX+5)°°³¶° 	JRIF	1EC5H°°³¸° 	JRIF	1B1AH°°´°± 	JRIF	1F76H°°´°´ 	JRIF	1FAAH°°´°· 	JRIF	1FC4H°°´±° 	LD	DE,1D5BH°°´²° 	LD	L,(IX+2)°°´³° 	LD	H,(IX+3)°°´´° 	CALL	1C90H°°´µ° 	EXX°°´¶° 	POP	IX°°´·° 	JR	Z,QT°°´¸° 	EXX°°µ±° 	MOVE	4,1A82H,SK2°°µ³° 	EXX°°µ³± 	JP	1D78H°°µµ° QT	RST	10H°°µ¶° 	PUSH	AF°°µ·° 	CP	'"'°°µ¸° 	JR	Z,QT1°°µ¹° 	POP	AF°°¶°° 	RET°°¶±° QT1	POP	AF°°¶²° QT2	RST	10H°°¶³° 	JR	NZ,QT3°°¶´° 	OR	A°°¶µ° 	RET	Z°°¶¶° QT3	CP	'"'°°¶·° 	JR	NZ,QT2°°¶¸° 	JP	1D78H°°¶¹° CG	EXX°°·°° 	POP	IX°°·±° CR	CALL	1D78H°°·²° 	LD	DE,0°°·²µ 	RET	Z°°·³° 	JP	C,1E60H°°·´° 	CALL	2337H°°·µ° 	RST	20H°°·¶° 	JR	Z,CG1°°··° 	PUSH	HL°°·¸° 	CALL	0FBDH°°¸±° 	CALL	1E5AH°°¸²° 	POP	HL°°¸´° L99	DEC	HL°°¸µ° 	JP	1D78H°°¸¶° CG1	LD	DE,(4121H)°°¸·° 	PUSH	HL°°¸¸° 	EXX°°¸¹° 	LD	HL,40B5H°°¹°° 	LD	(40B3H),HL°°¹±° 	LD	HL,(40A4H)°°¹²° CG2	LD	A,(HL)°°¹³° 	INC	HL°°¹´° 	LD	B,(HL)°°¹µ° 	LD	C,A°°¹¶° 	OR	B°°¹·° 	JP	Z,1ED9H°°¹¸° 	INC	HL°°¹¹° 	LD	E,(HL)°±°°° 	INC	HL°±°±° 	LD	D,(HL)°±°²° 	CALL	1D78H°±°³° 	CP	'"'°±°´° 	JR	Z,CG3°±°µ° CG4	LD	H,B°±°¶° 	LD	L,C°±°·° 	JR	CG2°±°¸° CG3	EXX°±°¹° 	EX	DE,HL°±±°° 	LD	B,(HL)°±±±° 	INC	HL°±±²° 	LD	E,(HL)°±±³° 	INC	HL°±±´° 	LD	D,(HL)°±±µ° 	DEC	HL°±±¶° 	DEC	HL°±±·° 	EX	DE,HL°±±¸° CG5	LD	A,B°±±¹° 	OR	A°±²°° 	JR	Z,CG6°±²±° 	LD	A,(HL)°±²²° 	INC	HL°±²³° 	EXX°±²´° 	INC	HL°±²µ° 	CP	(HL)°±²¶° 	JR	NZ,CG4°±²·° 	EXX°±²¸° 	DJNZ	CG5°±²¹° CG6	EXX°±³°° 	INC	HL°±³±° 	LD	A,(HL)°±³²° 	POP	HL°±³³° 	OR	A°±³´° 	JR	Z,L99°±³µ° 	CP	'"'°±³¶° 	JR	Z,L99°±³·° 	PUSH	HL°±³¸° 	JR	CG4°±³¹° T1	EXX°±´°° 	POP	BC°±´±° 	POP	DE°±´²° 	LD	HL,1D21H°±´³° 	CALL	1C90H°±´´° 	PUSH	DE°±´µ° 	PUSH	BC°±´¶° 	EXX°±´·° 	RET	NZ°±´¸° T10	DEC	HL°±´¹° 	RST	10H°±µ°° 	RET	Z°±µ±° 	PUSH	HL°±µ²° 	LD	HL,(40E6H)°±µ³° 	LD	A,(HL)°±µ´° 	OR	A°±µµ° 	JR	NZ,INS°±µµ± 	INC	HL°±µµ² 	INC	HL°±µµ³ 	INC	HL°±µµ´ 	INC	HL°±µµµ INS	RST	10H°±µ¸° 	POP	HL°±µ¹° 	CP	0BBH°±¶°° 	JR	NZ,T2°±¶±° 	CALL	2B02H°±¶²° 	EX	DE,HL°±¶³° 	LD	(40A4H),HL°±¶´° 	DEC	HL°±¶µ° 	LD	(HL),0°±¶¶° 	POP	HL°±¶·° 	JP	1B4AH°±¶¸° T2	CP	90H°±¶¹° 	JR	NZ,T3°±·°° 	DEC	HL°±·±° 	CALL	CR°±·²° 	PUSH	HL°±·³° 	CALL	1B2CH°±·´° 	JP	NC,1ED9H°±·µ° 	DEC	BC°±·¶° 	LD	(40FFH),BC°±··° 	POP	HL°±·¸° 	RET°±·¹° T3	CP	0B1H°±¸°° 	JR	NZ,T4°±¸±° 	INC	DE°±¸²° 	PUSH	DE°±¸³° 	RST	8°±¸´° 	DEFB	','°±¸µ° 	CALL	2B1CH°±¸¶° 	POP	DE°±¸·° 	LD	(DE),A°±¸¸° 	JR	T10°±¸¹° T4	CP	0B8H°±¹°° 	RET	NZ°±¹±° 	POP	BC°±¹²° 	PUSH	DE°±¹³° 	RST	8°±¹´° 	DEFB	','°±¹µ° 	CALL	2B02H°±¹¶° 	LD	(40B1H),DE°±¹·° 	POP	DE°±¹¸° 	JP	1E80H°²°°° TTSP	PUSH	AF°²°±° 	ADD	HL,SP°²°²° 	LD	A,(HL)°²°³° 	CP	E°²°´° 	JR	NZ,TT0°²°µ° 	INC	HL°²°¶° 	LD	A,(HL)°²°·° 	CP	D°²°¸° 	JR	NZ,TT0°²°¹° 	LD	(HL),B°²±°° 	DEC	HL°²±±° 	LD	(HL),C°²±²° TT0	POP	AF°²±³° 	RET°²±´° TT1	EXX°²±µ° 	MOVE	6,2FE6H,SK1°²±¸´ 	MOVE	6,2F46H,SK5°²±¹° 	EXX°²²°° 	RET°²²±° TT3	EXX°²²´° 	MOVE	4,1A6BH,SK3°²²¶° 	EXX°²²·° 	JP	1C90H°²²¸° SK1	POP	BC°²²¹° 	POP	DE°²³°° 	LD	A,D°²³±° 	AND	E°²³²° 	INC	A°²³³° 	LD	HL,(40A7H)°²³´° 	DEC	HL°²³µ° 	RET	Z°²³¶° 	SCF°²³·° 	INC	HL°²³¸° 	PUSH	AF°²³¹° 	JP	SK21°²´°° SK2	INC	A°²´±° 	DEC	A°²´²° 	JP	Z,1A33H°²´³° 	PUSH	AF°²´´° 	CALL	1E5AH°²´µ° SK20	DEC	HL°²´¶° 	LD	A,(HL)°²´·° 	CP	20H°²´¸° 	JR	Z,SK20°²´¹° 	INC	HL°²µ°° 	LD	A,(HL)°²µ±° 	CP	20H°²µ²° 	CALL	Z,09C9H°²µ³° SK21	PUSH	DE°²µ´° 	CALL	CMPRES°²µµ° 	JP	1A9CH°²µ¶° SK3	POP	DE°²µ·° 	JP	NC,1A5AH°²µ¸° 	LD	(40E2H),HL°²µ¹° 	OR	0FFH°²¶°° 	LD	HL,(40A7H)°²¶±° 	DEC	HL°²¶²° 	RET	Z°²¶³° 	SCF°²¶´° 	INC	HL°²¶µ° 	PUSH	AF°²¶¶° 	PUSH	DE°²¶·° 	CALL	CMPRES°²¶¸° 	JP	1A9CH°²¶¹° SK4	CALL	EXT°²·°° 	JP	2B6AH°²·°± SK5	POP	BC°²·°² 	POP	HL°²·°³ 	PUSH	HL°²·°´ 	CALL	0FAFH°²·°µ 	LD	A,20H°²·°¶ 	CALL	32AH°²·°· 	JP	2E86H°²·±° EXT	PUSH	HL°²·²° 	LD	HL,(40A7H)°²·³° 	LD	B,H°²·´° 	LD	C,L°²·µ° 	POP	HL°²·¶° 	LD	D,0FFH°²··° 	JR	EXT1°²·¸° EXT0	INC	BC°²·¹° 	DEC	D°²¸°° 	RET	Z°²¸±° EXT1	LD	A,(HL)°²¸²° 	OR	A°²¸³° 	INC	HL°²¸´° 	LD	(BC),A°²¸µ° 	RET	Z°²¸¶° 	JP	P,EXT0°²¸·° 	CP	0FBH°²¸¸° 	JR	NZ,EXT2°²¸¹° 	DEC	BC°²¹°° 	DEC	BC°²¹±° 	DEC	BC°²¹²° 	DEC	BC°²¹³° 	INC	D°²¹´° 	INC	D°²¹µ° 	INC	D°²¹¶° 	INC	D°²¹·° EXT2	CP	95H°²¹¸° 	CALL	Z,0B24H°²¹¹° 	SUB	7FH°³°°° 	PUSH	HL°³°±° 	LD	E,A°³°²° 	LD	HL,TABLE°³°³° EXT3	LD	A,(HL)°³°´° 	OR	A°³°µ° 	INC	HL°³°¶° 	JP	P,EXT3°³°·° 	DEC	E°³°¸° 	JR	NZ,EXT3°³°¹° 	AND	7FH°³±°° EXT4	LD	(BC),A°³±±° 	INC	BC°³±²° 	DEC	D°³±³° 	JP	Z,28D8H°³±´° 	LD	A,(HL)°³±µ° 	INC	HL°³±¶° 	OR	A°³±·° 	JP	P,EXT4°³±¸° 	POP	HL°³±¹° 	JR	EXT1°³²°° SK6	POP	DE°³²±° 	PUSH	DE°³²²° 	CALL	1B2CH°³²³° 	LD	H,B°³²´° 	LD	L,C°³²µ° 	INC	HL°³²¶° 	INC	HL°³²·° 	INC	HL°³²¸° 	INC	HL°³²¹° 	CALL	EXT°³³°° 	JP	2E86H°³³±° CMPRES	XOR	A°³³²° 	LD	(40B0H),A°³³³° 	LD	C,A°³³´° 	EX	DE,HL°³³µ° 	LD	HL,(40A7H)°³³¶° 	DEC	HL°³³·° 	DEC	HL°³³¸° 	EX	DE,HL°³³¹° CM0	LD	A,(HL)°³´°° 	CP	20H°³´±° 	JP	Z,CMB°³´²° 	LD	B,A°³´³° 	CP	22H°³´´° 	JP	Z,CMF°³´µ° 	OR	A°³´¶° 	JP	Z,CMG°³´·° 	LD	A,(40B0H)°³´¸° 	OR	A°³´¹° 	LD	A,(HL)°³µ°° 	JP	NZ,CMB°³µ±° 	CP	3FH°³µ²° 	LD	A,0B2H°³µ³° 	JP	Z,CMB°³µ´° 	LD	A,(HL)°³µµ° 	CP	30H°³µ¶° 	JR	C,CM1°³µ·° 	CP	3CH°³µ¸° 	JP	C,CMB°³µ¹° CM1	PUSH	DE°³¶°° 	LD	DE,TABLE-1°³¶±° 	PUSH	BC°³¶²° 	LD	BC,CM8°³¶³° 	PUSH	BC°³¶´° 	LD	B,7FH°³¶µ° 	LD	A,(HL)°³¶¶° 	CP	61H°³¶·° 	JR	C,CM2°³¶¸° 	CP	7BH°³¶¹° 	JR	NC,CM2°³·°° 	AND	5FH°³·±° 	LD	(HL),A°³·²° CM2	LD	C,(HL)°³·³° 	EX	DE,HL°³·´° CM3	INC	HL°³·µ° 	OR	(HL)°³·¶° 	JP	P,CM3°³··° 	INC	B°³·¸° 	LD	A,(HL)°³·¹° 	AND	7FH°³¸°° 	RET	Z°³¸±° 	CP	C°³¸²° 	JR	NZ,CM3°³¸³° 	EX	DE,HL°³¸´° 	PUSH	HL°³¸µ° CM4	INC	DE°³¸¶° 	LD	A,(DE)°³¸·° 	OR	A°³¸¸° 	JP	M,CM7°³¸¹° 	LD	C,A°³¹°° 	LD	A,B°³¹±° 	CP	8DH°³¹²° 	JR	NZ,CM5°³¹³° 	RST	10H°³¹´° 	DEC	HL°³¹µ° CM5	INC	HL°³¹¶° 	LD	A,(HL)°³¹·° 	CP	61H°³¹¸° 	JR	C,CM6°³¹¹° 	AND	5FH°´°°° CM6	CP	C°´°±° 	JR	Z,CM4°´°²° 	POP	HL°´°³° 	JR	CM2°´°´° CM7	LD	C,B°´°µ° 	POP	AF°´°¶° 	EX	DE,HL°´°·° 	RET°´°¸° CM8	EX	DE,HL°´°¹° 	LD	A,C°´±°° 	POP	BC°´±±° 	POP	DE°´±²° 	EX	DE,HL°´±³° 	CP	95H°´±´° 	LD	(HL),3AH°´±µ° 	JR	NZ,CM9°´±¶° 	INC	C°´±·° 	INC	HL°´±¸° CM9	CP	0FBH°´±¹° 	JR	NZ,CMA°´²°° 	LD	(HL),3AH°´²±° 	INC	HL°´²²° 	LD	B,93H°´²³° 	LD	(HL),B°´²´° 	INC	HL°´²µ° 	EX	DE,HL°´²¶° 	INC	C°´²·° 	INC	C°´²¸° 	JR	CMF°´²¹° CMA	EX	DE,HL°´³°° CMB	INC	HL°´³±° 	LD	(DE),A°´³²° 	INC	DE°´³³° 	INC	C°´³´° 	SUB	3AH°´³µ° 	JR	Z,CMC°´³¶° 	CP	4EH°´³·° 	JR	NZ,CMD°´³¸° CMC	LD	(40B0H),A°´³¹° CMD	SUB	59H°´´°° 	JP	NZ,CM0°´´±° 	LD	B,A°´´²° CME	LD	A,(HL)°´´³° 	OR	A°´´´° 	JR	Z,CMG°´´µ° 	CP	B°´´¶° 	JR	Z,CMB°´´·° CMF	INC	HL°´´¸° 	LD	(DE),A°´´¹° 	INC	C°´µ°° 	INC	DE°´µ±° 	JR	CME°´µ²° CMG	LD	HL,0005H°´µ³° 	LD	B,H°´µ´° 	ADD	HL,BC°´µµ° 	LD	B,H°´µ¶° 	LD	C,L°´µ·° 	LD	HL,(40A7H)°´µ¸° 	DEC	HL°´µ¹° 	DEC	HL°´¶°° 	DEC	HL°´¶±° 	LD	(DE),A°´¶²° 	INC	DE°´¶³° 	LD	(DE),A°´¶´° 	INC	DE°´¶µ° 	LD	(DE),A°´¶¶° 	RET°´¶¸° PRI	CP	23H°´¶¹° 	RET	NZ°´·°° 	CALL	2828H°´·±° 	PUSH	HL°´·²° 	LD	(4044H),HL°´·³° 	RST	10H°´·´° 	CALL	2337H°´·µ° 	RST	20H°´·¶° 	JR	Z,PRINI1°´··° 	POP	HL°´·¸° 	DEC	HL°´·¹° 	JP	1D78H°´¸°° PRINI1	RST	8°´¸±° 	DEFB	','°´¸²° 	LD	DE,(40A7H)°´¸³° 	LD	(4040H),DE°´¸´° 	XOR	A°´¸µ° 	LD	(4042H),A°´¸¶° 	LD	(4025H),A°´¸·° 	INC	A°´¸¸° 	LD	(409CH),A°´¸¹° 	LD	(4043H),A°´¹°° 	POP	DE°´¹±° 	RET°´¹²° TT4	EXX°´¹µ° 	MOVE	8,2B67H,SK4°´¹¹° 	MOVE	8,2E86H,SK6°µ°±° 	EXX°µ°²° 	LD	A,(4043H)°µ°³° 	DEC	A°µ°´° 	RET	NZ°µ°µ° 	PUSH	HL°µ°¶° 	LD	HL,(4040H)°µ°·° 	LD	(HL),C°µ°¸° 	INC	HL°µ°¹° 	LD	(4040H),HL°µ±°° 	LD	HL,4042H°µ±±° 	XOR	A°µ±²° 	INC	(HL)°µ±³° 	CALL	Z,XRES0°µ±´° 	JP	C,29A3H°µ±µ° 	POP	HL°µ±¶° 	RET°µ±·° PRE	LD	A,(4043H)°µ±¸° 	DEC	A°µ±¹° 	RET	NZ°µ²°° 	CALL	XRES0°µ²±° 	PUSH	DE°µ²²° 	PUSH	BC°µ²³° 	PUSH	HL°µ²´° 	LD	HL,(4044H)°µ²µ° 	RST	8°µ²¶° 	DEFB	'#'°µ²·° 	CALL	260DH°µ²¸° 	PUSH	DE°µ²¹° 	LD	HL,(4040H)°µ³°° 	LD	(HL),0°µ³±° 	LD	HL,(40A7H)°µ³²° 	DEC	HL°µ³³° 	LD	B,0°µ³´° 	CALL	2868H°µ³µ° 	POP	DE°µ³¶° 	POP	HL°µ³·° 	LD	BC,PREXI1°µ³¸° 	PUSH	BC°µ³¹° 	PUSH	DE°µ´°° 	XOR	A°µ´±° 	JP	1F32H°µ´²° PREXI1	POP	BC°µ´³° 	POP	DE°µ´´° 	RET°µ´´± XRES0	XOR	A°µ´´² 	LD	(409BH),A°µ´µ° XRES	XOR	A°µ´¶° 	LD	(4043H),A°µ´·° 	LD	A,6°µ´¸° 	LD	(4025H),A°µ´¹° 	SCF°µµ°° 	RET°µµ±° TABLE	EQU	$°µµ²° 	END	2B2H